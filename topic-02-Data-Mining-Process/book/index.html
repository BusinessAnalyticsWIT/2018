 <!DOCTYPE html>
 <html>
   <head>

     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">

     

     <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css" type="text/css">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css" rel="stylesheet" />

     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
     <script>hljs.initHighlightingOnLoad();</script>

     

     <style>
       

body 
{
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
}

figcaption
{
  margin-bottom: 20px;
}

.vertical-align
{
  display: flex;
  align-items: center;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}



     </style>

   </head>

  <body>
    

<style>
  

code
{
  font-family: "Monaco";
  font-size: 110%;
}

img
{
  padding:1px;
  border:1px solid black;
}

h1
{
  font-style:italic;
  font-size:130%;
  border-bottom:thin solid black;
}

h2
{
  font-size:110%;
  border-bottom: thin solid black;
}

h3
{
  font-size:100%;
  border-bottom: thin solid black;
}

body
{
  overflow-y: scroll;
}

.pushable > .pusher
{
  padding-bottom: 1.5rem;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}



</style>

<div class="ui fixed top pointing inverted stackable menu labmenu">
  <header class="header item">
    <i id="toc" class="sitemap icon"></i>
    <a href="../index.html">
      Data Mining Process CRISP DM
    </a>
  </header>
  <div class="right tab-menu menu">
    
    <a class="item" data-tab="Lab-02">
      Lab-02
    </a>
    
    <a class="item" data-tab="01">
      01
    </a>
    
    <a class="item" data-tab="02">
      02
    </a>
    
    <a class="item" data-tab="03">
      03
    </a>
    
    <a class="item" data-tab="04">
      04
    </a>
    
    <a class="item" data-tab="05">
      05
    </a>
    
    <a class="item" data-tab="06">
      06
    </a>
    
    <a class="item" data-tab="07">
      07
    </a>
    
    <div class="item">
      
    </div>
  </div>
</div>

<div class="ui segment pushable">
  <div class="ui inverted labeled icon left inline vertical sidebar menu">
    
      
        <a class="item" href="../../topic-02-BA-Intro/book-0-Excel-basics/index.html">
          Lab-01
        </a>
      
    
      
        <a class="item" href="../../topic-02-Data-Mining-Process/book/index.html">
          Lab-02
        </a>
      
    
  </div>
  <div class="pusher" tabindex="-1">
    <div class="ui basic segment" id="labchat">
      <br>
      
      <div  class="ui tab segment lab" data-tab="Lab-02">
        <p>Objectives</p>
<p>This lab will focus on how to effectively clean data in excel using the available functions.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="01">
        <h1>Dataset cleaning</h1>
<p>Cleaning data is a very important task for a data analyst. There are some functions in Excel you can use to support this process.</p>
<p>Some data when imported into Excel brings with it old formatting from the source system, this may be as symbols, concatenation of strings or duplicate values. It is essential to prepare the data for analysis and thus limit the issues that may arise</p>
<p>The image below shows each piece of data has a symbol prefixing the actual value.</p>
<p><img src="./img/01.png" alt=""></p>
<p>In this example it is important to strip off the leading paragraph symbol.</p>
<p>The Clean() function will remove any of the non-printable symbols that you may get in your data when it is imported from various sources.</p>
<p>Open the following file:</p>
<ul>
<li><a href="./archives/cleaning.xlsx">cleaning</a></li>
</ul>
<p>Using the clean() formula as below enter the formula into cell B14:</p>
<pre><code>=clean(B4)</code></pre>
<p>Copy the formula down to B20, click the menu button that appears beside the copied cells and choose fill without formatting to ensure just the formula is copied and not the coloured cell format.</p>
<p><img src="./img/02.png" alt=""></p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="02">
        <h1>Text to columns</h1>
<p>Another common data problem is the concatenation of strings with a delimiter or separator in between each value. This a simple text extract file which can drastically shrink file size of a data set but is impossible to work with in terms of data analysis.</p>
<p>In the worksheet highlight the data in cells J6:J11 and then on the data ribbon click the button Text to Columns.</p>
<p>This tool allows us to change text strings into separate columns easier to use. In this case each value is separated by a delimiter the underscore, choose the delimited option and click next.</p>
<p><img src="./img/03.png" alt=""></p>
<p>The default delimiter is the Tab and there are other options such as comma or semi colon. Check Other and type in an underscore.</p>
<p>The preview function is very useful to see if your data looks correct once separated.</p>
<p><img src="./img/04.png" alt=""></p>
<p>click finish (or click next and ensure the data types are set as expected).</p>
<p><img src="./img/05.png" alt=""></p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="03">
        <h1>Trim</h1>
<p>Open the sheet named Trim(), here we have rows of data that describe products. There are extra spaces between many of the letters and numbers in the data.</p>
<p>The trim function will strip extra spaces from text, leaving only single spaces between words and no space characters at the start or end of text.</p>
<pre><code>
 =trim(B5)</code></pre>
<p><img src="./img/06.png" alt=""></p>
<p>Hit enter. The contents should now show without extra spaces.</p>
<p>Drag down the formula so it is copied for each of the cells from B16 to B22</p>
<p><img src="./img/07.png" alt=""></p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="04">
        <h1>Substitute Values</h1>
<p>It is also possible to use the trim function with the substitution function.</p>
<p>In this data there is a comma separating some of the numbers where we would prefer a decimal point. There are also the extra spaces to deal with.</p>
<p><img src="./img/08.png" alt=""></p>
<pre><code>
=TRIM(Substitute(B4,&quot;,&quot;,&quot;.&quot;))</code></pre>
<p>All text values must be in quotes so the comma is in quotes and the decimal point.</p>
<p><img src="./img/09.png" alt=""></p>
<p>Copy the formula to the end of the data.</p>
<p>This task could of been done using the find and replace tool in excel however it is always best practice to keep the  raw data in its original form. It allows you to look back at the original data to check, especially if you conduct a lot of clean up.</p>
<p>Investigate the use of Find and Replace command.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="05">
        <h1>Values</h1>
<h2>Substitute</h2>
<p>Using the substitute function again you will create a new list of data for the years 2015 2016.</p>
<p><img src="./img/10.png" alt=""></p>
<pre><code>
=substitute(G5,&quot;2013&quot;,&quot;2015&quot;)</code></pre>
<p>This formula will work for the first four lines of data so copy it down, then edit the formula so that 2014 changes to 2016.</p>
<h2>Text</h2>
<p>The next issue in raw data is also common when pulling data from other sources and then combining the data in an excel sheet.</p>
<p>Open the Values sheet and you will see Excel marks with a green triangle each value in the table.</p>
<p><img src="./img/11.png" alt=""></p>
<p>When you click on the cell the error sign pops up. By clicking on the arrow we can see that this number is actually stored as text.</p>
<p><img src="./img/12.png" alt=""></p>
<p>In the arrow menu we have a function to convert the cells to numbers one by one. If a number is stored as text we cannot use some of the most common functions such as sum, or average. Consequently, the sum function in cell B11 returns zero.</p>
<p>There are two methods for converting these values.</p>
<p>Using the value function:</p>
<pre><code>
=value(B4)</code></pre>
<p><img src="./img/13.png" alt=""></p>
<p>Copy the formula down and the errors have been removed and the values are now numbers. The sum function should now work.</p>
<p><img src="./img/14.png" alt=""></p>
<p>Using text to columns:</p>
<p>Select the raw data, click text to column from the data ribbon, choose delimited and click next. Uncheck Tab and other as we are only dealing with one piece of data. Click next. The text to columns function knows that the data is numeric. General converts numeric values to numbers, date values to dates and all remaining values to text. Choose the destination as our table below.</p>
<p><img src="./img/15.png" alt=""></p>
<p>Now the values are numeric and the sum function works.</p>
<p><img src="./img/16.png" alt=""></p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="06">
        <h1>Sorting</h1>
<p>Open the following file</p>
<ul>
<li><a href="./archives/cleaning2.xlsx">cleaning2</a></li>
</ul>
<p>In the worksheet ExtraRows, we’ve got some valuable information here. Within each department, for example, ADC we see a list of information about the people who work in that department. And scrolling up and down you can see over in column A how the data is indented and every time we have a new department, we&#39;ve got a new list with a new heading. That heading does repeat the information that we see to the right.</p>
<ul>
<li>There are many rows with subheadings such as ADC or Admin training but have empty cells in the rest of the row. It would not be efficient to delete each row, there’s hundreds of them.</li>
<li>To deal with this issue we could sort the data. Pick a column other than A (it has no empty cells) For example, Click in column C, choose the Sort button on Data ribbon.</li>
</ul>
<p><img src="./img/19.png" alt=""></p>
<ul>
<li>If it asks then choose Expand selection. Then choose sort by Department in A to Z. Note, Excel recognises &#39;My data has headers&#39; so row 1 does not get involved in the sort.</li>
</ul>
<p><img src="./img/20.png" alt=""></p>
<p>The titles if you investigate are at the bottom of the sheet. If you press Ctrl End you will see them, and delete them if you wish.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="07">
        <h1>Dates</h1>
<p>Open the following workbook:</p>
<ul>
<li><a href="./archives/dates.xlsx">dates</a></li>
</ul>
<p>There are some entries in column A, also in column C, that are similar, they&#39;re in reverse order. They&#39;ve got month and year but not a day associated with them.</p>
<ul>
<li>In column E we&#39;ve got all three of the date parts, but in a different layout. The key to converting these many times is a combination of using a function called DATE as displayed in this generic form here in cell B1 and also some of the text functions, like left and right, that allow us to extract data from the left side or right side of a cell.</li>
</ul>
<p>See the format below:</p>
<p><img src="./img/21.png" alt=""></p>
<ul>
<li>The key to converting these many times is a combination of using a function called DATE as displayed in this generic form here in cell B1 and also some of the text functions, like left and right, that allow us to extract data from the left side or right side of a cell.</li>
</ul>
<p><img src="./img/22.png" alt=""></p>
<ul>
<li><p>In cell B2:  =date ... link to the year out of cell A2. To access the four right-most characters, we use the function right. Cell A2 comma 4, meaning pull out those four right-most characters, that&#39;s the year.</p>
</li>
<li><p>Then we need the month, that&#39;s the two left-most characters. We&#39;re in cell A2 again comma two. Now there&#39;s no day over there, so let&#39;s simply make it be day one, first day of the month, comma one. Right parenthesis. We&#39;ve got a date.</p>
</li>
<li><p>Copy/autofill this down the column.</p>
</li>
<li><p>We might also need something almost the same in column D. Since this formula we just created is based on the cell to its left, we can copy this formula we just created in column B. We’ve a different layout. So you can edit it as follows:</p>
</li>
</ul>
<p><img src="./img/23.png" alt=""></p>
<ul>
<li>In column E the date is formatted differently, it includes the 3 parts to the date. Notice J and K showing each month and sequence – this could be helpful here.</li>
<li>To input a formula in F1 to format column E we could use a lookup table to somehow come up with the actual numbers. E.g., September is nine, the ninth month and so on. This is done inside out here. So in cell E2, how to get Sep to recognise as ‘9’.</li>
<li>Use a function called Mid. ‘6’ represents the space where ‘S’ for Sep starts in cell E2. ‘3’ represents the 3 characters – ‘Sep’. Hit enter, that will give us ‘Sep’ in cell F2.</li>
</ul>
<p><img src="./img/24.png" alt=""></p>
<ul>
<li>To replace the ‘Sep’ with ‘9’, we use the Vlookup function. The purpose of the Vlookup is: I&#39;ve got a value somewhere, in other words for Sep…I want to compare it with a table of data somewhere. That table in this example is over in columns J and K. See function format below:</li>
</ul>
<p><img src="./img/25.png" alt=""></p>
<ul>
<li><p>Start with:
{{{
=VLOOKUP(MID(E2,6,3),J:K,2,FALSE)
}}}</p>
</li>
<li><p>The ‘2’ means the second column which is ‘K’ and ‘FALSE’ means – choosing exact match. If all goes well, it should have ‘9’ as the answer. Convert this to Number – general format from home ribbon. Just to test this in column ‘F’, autofill down this column ‘F’ to see if it picked up the month as the numerical field:</p>
</li>
</ul>
<p><img src="./img/26.png" alt=""></p>
<ul>
<li>All that, to come up with a month!! To format the Date in column E – edit the formula as follows:</li>
</ul>
<p><img src="./img/27.png" alt=""></p>
<ul>
<li>At different times your going to have to go to these unusual lengths to achieve Date formatting:</li>
</ul>
<p><img src="./img/28.png" alt=""></p>
<ul>
<li>To clean up the columns, we won’t want the original column now that we have reformatted. To quickly copy, bring your mouse to any edge of column F, hold it, begin to move it to next column, click right button of mouse to choose option with copying.</li>
</ul>
<p><img src="./img/29.png" alt=""></p>

      </div>
     
    </div>
  </div>
</div>
<!--<div class="ui bottom fixed borderless right menu">
  <div class="ui right tiny menu">
    <div class="ui mini message segment">
      .
      <a href="http://creativecommons.org/licenses/by-nc/4.0/"
         title="External link to http://creativecommons.org/licenses/by-nc/4.0/"
         target="_blank">Creative Commons License
      </a>
    </div>
  </div>
</div>-->

<script>
  $(document).on('keydown', function(e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

</script>



    <footer>

    </footer>
    <script>
      $(document).ready(function() {
  $('img').addClass('ui image');

  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass(
        'ui basic segment',
      );
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass(
        'ui blue ribbon label',
      );
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.menu .item').tab({
    history: true,
    historyType: 'hash',
  });

  $('.popup').popup();

  $('.ui.sidebar')
    .sidebar({ context: $('.pushable') })
    .sidebar('setting', 'transition', 'slide out')
    .sidebar('attach events', '#toc');
});

    </script>
  </body>

 </html>